sap.ui.define(
	["sap/ui/core/mvc/Controller",
	"sap/ui/model/Filter",
	"sap/ui/model/FilterOperator"], 
	function(Controller, Filter, FilterOperator) {
	"use strict";
	return Controller.extend("infy.fin.ap.controller.View1", {
		/**
		 * Called when a controller is instantiated and its View controls (if available) are already created.
		 * Can be used to modify the View before it is displayed, to bind event handlers and do other one-time initialization.
		 * @memberOf infy.fin.ap.view.View1
		 */
		onInit: function() {
			//How to obtain Router object which is possessed by our Component.js
			this._oRouter = this.getOwnerComponent().getRouter();
		},
		onNext: function(sIndex) {
			//get the parent of the view - app container control
			//var oAppContainer = this.getView().getParent().getParent();
			//oAppContainer.toDetail("idView2");
			this._oRouter.navTo("detail",{
				anubhav: sIndex
			});
		},
		onClick: function(oEvent){
			var oList = this.getView().byId("idList");
			var aItems = oList.getSelectedItems();
			for(var i=0;i<aItems.length;i++){
			  //console.log(aItems[i].getTitle());
			  aItems[i].addStyleClass("anubhavRocks");
			}
		},
		onSelectedItem: function(oEvent){
			// //Getting the address of the item seleected by the user - Address of ELEMENT
			var sPath = oEvent.getParameter("listItem").getBindingContextPath();
			var sIndex = sPath.split("/")[sPath.split("/").length - 1];
			this.onNext(sIndex);	
		},
		onDelete: function(oEvent){
			var itemToBeDeleted = oEvent.getParameter("listItem");
			oEvent.getSource().removeItem(itemToBeDeleted);
		},
		onSearch: function(oEvent) {
			//This code was generated by the layout editor.
			//Step 1: Read the value from the search field - value from screen
			var searchVal = oEvent.getParameter("query");
			
			var oFilter = new Filter("name", FilterOperator.Contains, searchVal);
			var oFilterType = new Filter("type", FilterOperator.Contains, searchVal);
			var aFilter = [oFilter, oFilterType];
			var oFilterFinal = new Filter({
				filters: aFilter,
				and: false
			});
			var oList = this.getView().byId("idList");
			oList.getBinding("items").filter([oFilterFinal]);
			//var allItems = oList.getItems();
			//processing yourself to compare line by line and remove data which is not necessary
			//update data back to model
			//next change update and repeat the process
			
			// //Step 2: Get the object of view 2 with the help of parent
			// var oV2 = this.getView().getParent().getPages()[1];
			// //Step 3: Get the Page which is inside the view2
			// var oPage2 = oV2.getContent()[0];
			// //Step 4: Change the title of the page inside view2
			// oPage2.setTitle(searchVal);
			// oV2.byId("a").setValue(searchVal.split(" ")[0]);
			// oV2.byId("b").setValue(searchVal.split(" ")[1]);
			// oV2.byId("t1").setText(searchVal.split(" ")[0]);
			// oV2.byId("t2").setText(searchVal.split(" ")[1]);
		
			// //Step 5: Navigate to the view 2
			// this.onNext();
		}
	});
});